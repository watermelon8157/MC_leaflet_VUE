@using RCS_Data;
@using RCS.Models.DB;
@{
    //輔大版本-呼吸治療評估記錄表
    string imgSrc = "http://" + Request.Url.Authority + "/Images/FJU_P.jpg";//抬頭圖片位置
    string imgSrc2 = "http://" + Request.Url.Authority + "/Images/deviant_s.jpg";//呼吸音圖片
    int PageDevice = ViewBag.items_cnt;
    int PageCnt = ViewBag.pages_cnt;
    IPDPatientInfo PatientData = (IPDPatientInfo)ViewBag.patient_data;
    List<RTCXRPrtContainer> CXRPrt = (List<RTCXRPrtContainer>)ViewBag.cxr_prt;
    int DataCnt = CXRPrt.Count;
    int IniData = 0;
    int TempPageDevice = PageDevice;
    //string urlImage = ViewBag.img_url;
}
@for (int pageno = 1; pageno <= PageCnt; pageno++)
{
    for (int i = IniData; i < PageDevice; i++)
    {
        CXRPrt[i].data = new RTCXRPrtContainer.Document();
    }
    <table style="width:100%;height:100%;">
        <tr>
            <td>
                <table style="width: 100%; height: 100%;">
                    <tr>
                        <td style="width:30%;font-size:25px;">
                            <table cellspacing="1" cellpadding="2" style="border:1px solid #666; font-size: 12px;width:100%;">
                                <tr>
                                    <td>病歷號碼：</td>
                                    <td></td>
                                    <td>床號：</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>姓名：</td>
                                    <td></td>
                                    <td>性別：</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>出生日期：</td>
                                    <td colspan="3">&nbsp;&nbsp;年&nbsp;&nbsp;&nbsp;&nbsp;月&nbsp;&nbsp;&nbsp;&nbsp;日</td>
                                </tr>
                            </table>
                        </td>
                        <td width="50%" align="center" valign="middle" style="font-size:16px;">
                            <img src="@(imgSrc)" alt="gallery image or whatever" />
                            <br />呼吸治療肺復原記錄單
                        </td>
                        <td width="20%"></td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            病歷號:
                        </td>
                        <td width="30%" align="right">
                            第&nbsp;&nbsp;頁
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <table style="border-left: 1px solid;border-bottom:1px solid;border-right:1px solid; width: 100%; height: 100%; border-collapse: collapse;" class="tableText" cellpadding="5">
                                <tr>
                                    <td colspan="2" class="borderTopBlack showSize1" style="font-size: 14px;">診斷</td>
                                    <td colspan="@((1+2).ToString())" class="borderLeftBlack borderTopBlack showSize1" style="font-size: 14px;"></td>
                                    <td colspan="@(PageDevice-2)" class="borderLeftBlack borderTopBlack showSize1">
                                        □門診  □急診  □住院
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="borderTopBlack showSize1" style="font-size: 14px;">胸腔病史</td>
                                    <td colspan="@(PageDevice+1)" class="borderLeftBlack borderTopBlack showSize1"></td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="borderTopBlack showSize1" style="font-size: 14px;">肺功能檢查</td>
                                    <td colspan="1" class="borderLeftBlack borderTopBlack showSize1">
                                        FEV<sub class="sub">1</sub> /Pred_____%
                                    </td>
                                    <td colspan="2" class="borderTopBlack showSize1">
                                        FVC/Pred_____%
                                    </td>
                                    <td colspan="3" class="borderTopBlack showSize1">
                                        FEV<sub class="sub">1</sub>/FVC_____%
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1" style="font-size: 14px;">記錄時間</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1"></td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1">
                                        HR(rest/exercise)
                                    </td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.HRRest)/@(CXRPrt[i].data.HRExercise)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1">SpO<sub class="sub">2</sub>(rest/exercise)</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.SpO2Rest)/@(CXRPrt[i].data.SpO2Exercise)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1">BP(rest/exercise)</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.PulseRateRest)/@(CXRPrt[i].data.PulseRateExercise)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1">Borg Scale(rest/exercise)</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.BorgScaleRest)/@(CXRPrt[i].data.BorgScaleExercise)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1">6MWT/Distance</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1"></td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" rowspan="2" class="borderTopBlack showSize1">
                                        <table style="width:100px;">
                                            <tr>
                                                <td class="showSize1">
                                                    Breathing Sound:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Before/After Treatment
                                                </td>
                                                <td>
                                                    <img width="68" height="58" src="@(imgSrc2)" />
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    <td colspan="@(TempPageDevice)" class="borderLeftBlack borderTopBlack showSize2">
                                        1.Clear 2.Rhonchoi 3.Crackle 4.Wheeze 5.Stridor 6.Bronchial sound 7.Diminshed
                                    </td>
                                </tr>
                                <tr>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.BreathingSoundBefore)/@(CXRPrt[i].data.BreathingSoundAfter)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1" style="font-size: 14px;">使用之氧氣設備</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">
                                            @*@(CXRPrt[i].data.BreatheMode)*@
                                        </td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1">
                                        C.P.T./Postural Drainage/Lobe
                                    </td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1"></td>
                                    }
                                </tr>
                                <tr>
                                    <td rowspan="3" colspan="3" class="borderTopBlack showSize1">Drug Inhalation</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize2" style="height:24px;"></td>
                                    }
                                </tr>
                                <tr>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize2" style="height:24px;"></td>
                                    }
                                </tr>
                                <tr>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize2" style="height:24px;"></td>
                                    }
                                </tr>
                                <tr>
                                    <td rowspan="5" colspan="2" class="divCenter borderTopBlack showSize1" style="font-size:14px;">復<br />原<br />運<br />動</td>
                                    <td class="borderLeftBlack borderTopBlack showSize1" style="">IS:<span style="text-decoration: underline;">&nbsp;&nbsp;</span>cc x <span style="text-decoration: underline;">&nbsp;&nbsp;</span>sec</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@*@(CXRPrt[i].data.SMI)*@</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Vest</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.IPPB)</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Diaphragmatic Traning</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.DiaphragmaticTraining)</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Flutter/PEP<span style="text-decoration: underline;">&nbsp;&nbsp;</span>(cmH<sub class="sub">2</sub>O)</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.Flutter)/@(CXRPrt[i].data.PEP)</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Arm ergometer/Biking</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.Arm)/@(CXRPrt[i].data.LegExercise)</td>
                                    }
                                </tr>
                                <tr>
                                    <td rowspan="4" colspan="2" style="font-size:14px;" class="divCenter borderTopBlack showSize1">呼<br />吸<br />運<br />動</td>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Pursed lip</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.PursedLip)</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Auto draining</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.AutoDraining)</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Diaphragmatic breathing</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.DiaphragmaticBreathing)</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Huffing/Cough</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.Huffing)/@(CXRPrt[i].data.Cough)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1">Other</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1" style="height:48px;">
                                            @(CXRPrt[i].data.Other)
                                        </td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" rowspan="2" class="borderTopBlack showSize1">Cough Function</td>
                                    <td colspan="@(TempPageDevice)" class="borderLeftBlack borderTopBlack showSize1">
                                        1.Functional 2.Weakly Functional 3.Non-Functional
                                    </td>
                                </tr>
                                <tr>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1" style="height:24px;">@(CXRPrt[i].data.CoughFunction)</td>
                                    }
                                </tr>
                                <tr>
                                    <td rowspan="5" class="divCenter borderTopBlack showSize1" style="width:2%;font-size: 14px;">
                                        S<br />P<br />U<br />T<br />U<br />M
                                    </td>
                                    <td colspan="2" class="borderLeftBlack borderTopBlack showSize1" style="">
                                        Amount(none.mild.moderate.Amount)
                                    </td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.Quantity)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="2" rowspan="2" class="borderLeftBlack borderTopBlack showSize1">Color</td>
                                    <td colspan="@(TempPageDevice)" class="borderLeftBlack borderTopBlack showSize1">
                                        1.White 2.Yellow 3.Grey 4.Brown 5.Pink & Frothy 6.Blood-tinged 7.Green
                                    </td>
                                </tr>
                                <tr>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1" style="height:24px;">@(CXRPrt[i].data.Color)</td>
                                    }
                                </tr>
                                <tr>
                                    <td rowspan="2" class="borderLeftBlack borderTopBlack showSize1" style="width:10%;">Consistency</td>
                                    <td class="borderLeftBlack borderTopBlack showSize1">Thick</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.Thick)</td>
                                    }
                                </tr>
                                <tr>
                                    <td class="borderLeftBlack borderTopBlack showSize1" style="width:20%;">Thin/Tenacious</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">@(CXRPrt[i].data.Thin)/@(CXRPrt[i].data.Tenacious)</td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1" style="font-size: 14px;">CXR檢查結果</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">
                                            @(CXRPrt[i].data.CXRResult)
                                        </td>
                                    }
                                </tr>
                                <tr>
                                    <td colspan="3" class="borderTopBlack showSize1" style="font-size: 14px;">治療師簽章</td>
                                    @for (int i = IniData; i < PageDevice; i++)
                                    {
                                        <td class="divCenter borderLeftBlack borderTopBlack showSize1">
                                            @(CXRPrt[i].data.CreateName)
                                        </td>
                                    }
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <div>我是分頁</div>
    IniData += TempPageDevice;
    PageDevice += TempPageDevice;
}