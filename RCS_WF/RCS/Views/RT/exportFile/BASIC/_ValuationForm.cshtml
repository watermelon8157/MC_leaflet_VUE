@model RCS_Data.VentilatorStatusPrintData
@using RCS_Data;

@{
    IPDPatientInfo pat_info = Model.pat_info;
    UserInfo user_info = Model.user_info;

    var groupData = Model.CONSUMABLE_LIST.GroupBy(x => x.VENDER_CODE).ToList();

    string foneSize = "font-size:10px;";
}
<table>
    <tr>
        <td>
            <table style="width:95%;height:20%;">
                <tr>
                    <td>
                        <table style="width:67%;height:40%;">
                            <tr style="border:2px solid black;">
                                <td colspan="4" align="center" valign="middle" class="tilteSize tilteFontBold">
                                    [$AA$]
                                </td>
                            </tr>
                        </table>
                        <table style="width:67%;height:30%;">
                            <tr>
                                <td rowspan="2" cellspacing="1" cellpadding="0" style="font-size: 14px;width:50%;padding:0px;" align="left">
                                    單位： @pat_info.cost_code
                                </td>
                            </tr>
                        </table>
                        <table style="width:67%;height:30%;">
                            <tr>
                                <td rowspan="2" cellspacing="1" cellpadding="0" style="font-size: 14px;width:50%;padding:0px;" align="left">
                                    日期：@(Model.RECORD_DATE)
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <table style="width:30%;height:50%;">
                            <tr>
                                <td rowspan="2">
                                    <table cellspacing="1" cellpadding="2" style="border:2px solid black; font-size: 12px;">
                                        <tr>
                                            <td>病歷號碼:</td>
                                            <td>@pat_info.chart_no</td>
                                        </tr>
                                        <tr>
                                            <td>姓名:</td>
                                            <td>@pat_info.patient_name</td>
                                        </tr>
                                        <tr>
                                            <td>出生日期:</td>
                                            <td>@pat_info.birth_day</td>
                                        </tr>
                                        <tr>
                                            <td>床號:</td>
                                            <td>@pat_info.bed_no</td>
                                        </tr>
                                        <tr>
                                            <td>性別:</td>
                                            <td>@pat_info.genderCHT</td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                    @*<td colspan="4" style="width:100%;height:3%;" align="center" valign="middle" class="tilteSize">
                            胸腔內科呼吸治療計價單
                        </td>*@
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>
            <table style="width:95%;height:30%;border-collapse:collapse;">
                <tr>
                    <td style="width:50%;">
                        <table style="font-size:14px;width:100%;height:50%;">
                            <tr>
                                <td style="width:5%;" class="topBorder rightBorder leftBorder">
                                    <table>
                                        @for (int i = 0; i < groupData[0].First().VENDER_CODE.ToCharArray().Length; i++)
                                        {
                                            <tr><td>@groupData[0].First().VENDER_CODE.ToCharArray()[i]</td></tr>
                                        }
                                        <tr><td></td></tr>
                                    </table>
                                </td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;font-size:13.5px;">
                                        @for (int i = 0; i < groupData[0].Count(); i++)
                                        {
                                            <tr style="width:90%;">
                                                <td class="topBorder rightBorder" style="height:13%;width:26%;">
                                                    @groupData[0].ToList()[i].C_CNAME
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:2%;">
                                                    @groupData[0].ToList()[i].C_MEMO
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:8%;">
                                                    @groupData[0].ToList()[i].C_ID
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:5%;" align="center">
                                                    @if (Model.All.Where(x => x.ITEM_NAME == groupData[0].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE)) != 0)
                                                    {
                                                        @Model.All.Where(x => x.ITEM_NAME == groupData[0].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE))
                                                    }
                                                </td>
                                            </tr>
                                        }
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:5%;" class="topBorder rightBorder leftBorder">
                                    <table>
                                        @for (int i = 0; i < groupData[1].First().VENDER_CODE.ToCharArray().Length; i++)
                                        {
                                            <tr><td>@groupData[1].First().VENDER_CODE.ToCharArray()[i]</td></tr>
                                        }
                                        <tr><td></td></tr>
                                    </table>
                                </td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;font-size:13.5px;">
                                        @for (int i = 0; i < groupData[1].Count(); i++)
                                        {
                                            <tr style="width:90%;">
                                                <td class="topBorder rightBorder" style="height:13%;width:26%;">
                                                    @groupData[1].ToList()[i].C_CNAME
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:2%;">
                                                    @groupData[1].ToList()[i].C_MEMO
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:8%;">
                                                    @groupData[1].ToList()[i].C_ID
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:5%;" align="center">
                                                    @if (Model.All.Where(x => x.ITEM_NAME == groupData[1].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE)) != 0)
                                                    {
                                                        @(Model.All.Where(x => x.ITEM_NAME == groupData[1].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE)))
                                                    }

                                                </td>
                                            </tr>
                                        }
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:5%;" class="topBorder rightBorder leftBorder">
                                    <table>
                                        @for (int i = 0; i < groupData[2].First().VENDER_CODE.ToCharArray().Length; i++)
                                        {
                                            <tr><td>@groupData[2].First().VENDER_CODE.ToCharArray()[i]</td></tr>
                                        }
                                        <tr><td></td></tr>
                                    </table>
                                </td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;font-size:13.5px;">
                                        @for (int i = 0; i < groupData[2].Count(); i++)
                                        {
                                            <tr style="width:90%;">
                                                <td class="topBorder rightBorder" style="height:13%;width:26%;">
                                                    @groupData[2].ToList()[i].C_CNAME
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:2%;">
                                                    @groupData[2].ToList()[i].C_MEMO
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:8%;">
                                                    @groupData[2].ToList()[i].C_ID
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:5%;" align="center">
                                                    @if ((Model.All.Where(x => x.ITEM_NAME == groupData[2].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE))) != 0)
                                                    {
                                                        @(Model.All.Where(x => x.ITEM_NAME == groupData[2].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE)))
                                                    }

                                                </td>
                                            </tr>
                                        }
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:5%;" class="topBorder rightBorder leftBorder bottomBorder">
                                    <table>
                                        @for (int i = 0; i < groupData[3].First().VENDER_CODE.ToCharArray().Length; i++)
                                        {
                                            <tr><td>@groupData[3].First().VENDER_CODE.ToCharArray()[i]</td></tr>
                                        }
                                        <tr><td></td></tr>
                                    </table>
                                </td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;" class="bottomBorder">
                                        @for (int i = 0; i < groupData[3].Count(); i++)
                                        {
                                            <tr style="width:90%;">
                                                <td class="topBorder rightBorder" style="height:13%;width:26%;">
                                                    @groupData[3].ToList()[i].C_CNAME
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:2%;">
                                                    @groupData[3].ToList()[i].C_MEMO
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:8%;">
                                                    @groupData[3].ToList()[i].C_ID
                                                </td>
                                                <td class="topBorder rightBorder" style="height:13%;width:5%;" align="center">
                                                    @if ((Model.All.Where(x => x.ITEM_NAME == groupData[3].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE))) != 0)
                                                    {
                                                        @(Model.All.Where(x => x.ITEM_NAME == groupData[3].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE)))
                                                    }

                                                </td>
                                            </tr>
                                        }
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td style="width:50%;">
                        <table style="font-size:14px;width:100%;height:50%;">
                            <tr>
                                <td style="width:5%;" class="topBorder rightBorder">
                                    <table>
                                        @for (int i = 0; i < groupData[4].First().VENDER_CODE.ToCharArray().Length; i++)
                                        {
                                            <tr><td>@groupData[4].First().VENDER_CODE.ToCharArray()[i]</td></tr>
                                        }
                                        <tr><td></td></tr>
                                    </table>
                                </td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;font-size:13.5px;">
                                        @for (int i = 0; i < groupData[4].Count(); i++)
                                        {
                                            <tr style="width:90%;">
                                                <td class="topBorder rightBorder" style="height:12%;width:26%;">
                                                    @groupData[4].ToList()[i].C_CNAME
                                                </td>
                                                <td class="topBorder rightBorder" style="height:12%;width:2%;">
                                                    @groupData[4].ToList()[i].C_MEMO
                                                </td>
                                                <td class="topBorder rightBorder" style="height:12%;width:8%;">
                                                    @groupData[4].ToList()[i].C_ID
                                                </td>
                                                <td class="topBorder rightBorder" style="height:12%;width:5%;" align="center">

                                                    @if ((Model.All.Where(x => x.ITEM_NAME == groupData[4].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE))) != 0)
                                                    {
                                                        @(Model.All.Where(x => x.ITEM_NAME == groupData[4].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE)))
                                                    }
                                                </td>
                                            </tr>
                                        }
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:5%;" class="topBorder rightBorder">
                                    <table>
                                        @for (int i = 0; i < groupData[5].First().VENDER_CODE.ToCharArray().Length; i++)
                                        {
                                            <tr><td>@groupData[5].First().VENDER_CODE.ToCharArray()[i]</td></tr>
                                        }
                                        <tr><td></td></tr>
                                    </table>
                                </td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;font-size:13.5px;">
                                        @for (int i = 0; i < groupData[5].Count(); i++)
                                        {
                                            <tr style="width:90%;">
                                                <td class="topBorder rightBorder" style="height:12%;width:26%;">
                                                    @groupData[5].ToList()[i].C_CNAME
                                                </td>
                                                <td class="topBorder rightBorder" style="height:12%;width:2%;">
                                                    @groupData[5].ToList()[i].C_MEMO
                                                </td>
                                                <td class="topBorder rightBorder" style="height:12%;width:8%;">
                                                    @groupData[5].ToList()[i].C_ID
                                                </td>
                                                <td class="topBorder rightBorder" style="height:12%;width:5%;" align="center">
                                                    @if ((Model.All.Where(x => x.ITEM_NAME == groupData[5].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE))) != 0)
                                                    {
                                                        @(Model.All.Where(x => x.ITEM_NAME == groupData[5].ToList()[i].C_ID).Sum(y => Int32.Parse(y.ITEM_VALUE)))
                                                    }
                                                </td>
                                            </tr>
                                        }
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:5%;" class="topBorder rightBorder">
                                    <table>
                                        <tr><td>其</td></tr>
                                        <tr><td>他</td></tr>
                                    </table>
                                </td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse">
                                        @for (int i = 0; i < 3; i++)
                                        {
                                            <tr style="width:90%;">
                                                <td class="topBorder rightBorder" style="height:12%;width:26%;"></td>
                                                <td class="topBorder rightBorder" style="height:12%;width:2%;"></td>
                                                <td class="topBorder rightBorder" style="height:12%;width:8%;"></td>
                                                <td class="topBorder rightBorder" style="height:12%;width:5%;"></td>
                                            </tr>
                                        }
                                    </table>
                                </td>
                            </tr>
                            <tr style="height:21.5%;width:100%;border:2px solid black;">
                                <td style="width:100%;" class="topBorder"></td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;font-size:13.5px;">
                                        <tr style="width:90%;">
                                            <td class="topBorder" style="height:100%;width:35%;" align="center">@user_info.user_name</td>
                                            <td class="topBorder rightBorder" style="height:100%;width:15%;" align="right" valign="bottom">呼吸治療師</td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr style="height:21.5%;width:100%;border:2px solid black;">
                                <td style="width:100%;" class="topBorder bottomBorder"></td>
                                <td>
                                    <table style="height:100%;width:100%;border-collapse:collapse;" class="bottomBorder">
                                        <tr style="width:90%;">
                                            <td class="topBorder" style="height:100%;width:35%;" align="center"></td>
                                            <td class="topBorder rightBorder" style="height:100%;width:15%;" align="right" valign="bottom">書記</td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
<div>我是分頁</div>





