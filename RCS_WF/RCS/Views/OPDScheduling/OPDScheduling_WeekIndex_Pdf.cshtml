@model  RCS_Data.Controllers.OPDScheduling.OPD_TREATMENT_VM
@using RCS.Models.ViewModel
@{
    ViewBag.Title = "OPDScheduling_WeekIndex_Pdf";
    RCS_Data.Controllers.OPDScheduling.OPD_TREATMENT_VM OPD_Treatment_List = (RCS_Data.Controllers.OPDScheduling.OPD_TREATMENT_VM)ViewBag.OPD_TreatmentNode;
}

<table border="1" cellpadding="5" style="border:2px solid;text-align:center;font-size: 10px;width:100%;height:100%;">
    <thead>
        <tr>
            <td colspan="21" align="center">
                @(OPD_Treatment_List.opd_title)&emsp;@(OPD_Treatment_List.weakenSdate)~@(OPD_Treatment_List.weakenEdate)
            </td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td></td>
            @for (int i = 1; i <= 5; i++)
            {
                <td colspan="4" style="border:1px solid;" align="center">
                    @(OPD_Treatment_List.opd_list[(i)].treatment_date) &emsp; @("(")@(OPD_Treatment_List.opd_list[(i)].treatment_day)@(")")
                </td>
            }
        </tr>
        <tr>
            <td>治療人數</td>
            @for (int i = 1; i <= 5; i++)
            {
                <td colspan="2" style="border:1px solid;" align="center">
                    @(OPD_Treatment_List.opd_list[i].treatment_person)
                </td>
                <td colspan="2" style="border:1px solid;" align="center">
                    @(OPD_Treatment_List.opd_6_min_list[i].treatment_person)
                </td>
            }
        </tr>
        @for (int i = 0; i < OPD_Treatment_List.timePer.Count; i++)
        {
            <tr>
                <td>
                    @string.Format("{0} ~ {1}", OPD_Treatment_List.timePer[i][0], OPD_Treatment_List.timePer[i][1])
                </td>
                @for (int j = 1; j <= 5; j++)
                {
                    <td colspan="2" style="border:1px solid;width:10% " align="center">
                        @if (OPD_Treatment_List.opd_list != null && OPD_Treatment_List.opd_list.Count > 0)
                        {
                            foreach (var item in OPD_Treatment_List.opd_list[j].opd_per[i].opd_pat)
                            {
                                @item.patient_name
                                <br />
                                @item.show_chart_no
                                <br />
                                <br />
                            }
                        }
                    </td>
                    <td colspan="2" style="border:1px solid; width:10%" align="center">
                        @if (OPD_Treatment_List.opd_6_min_list != null && OPD_Treatment_List.opd_6_min_list.Count > 0)
                        {
                            foreach (var itemA in OPD_Treatment_List.opd_6_min_list[j].opd_per[i].opd_pat)
                            {
                                @itemA.patient_name
                                <br />
                                @itemA.show_chart_no
                                <br />
                                <br />
                            }
                        }
                    </td>
                }
            </tr>
        }
    </tbody>
</table>
